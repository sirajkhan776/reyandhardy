{% extends "base.html" %}
{% load static %}
{% block content %}
<div class="row g-3">
  <div class="col-md-3">{% include "dashboard/_nav.html" %}</div>
  <div class="col-md-9">
    <div class="d-flex align-items-center justify-content-between mb-2">
      <h3 class="m-0">Orders</h3>
      <a href="/dashboard/orders/new/" class="btn btn-primary"><i class="bi bi-plus"></i> New Order</a>
    </div>
    <div class="d-flex align-items-center mb-2">
      <form class="ms-auto d-flex align-items-center gap-2" method="get" action="">
        <label class="text-muted small mb-0" for="statusFilter">Status</label>
        <select id="statusFilter" name="status" class="form-select form-select-sm" style="width:auto">
          <option value="all" {% if selected_status == 'all' %}selected{% endif %}>All</option>
          {% for key,label in status_choices %}
            <option value="{{ key }}" {% if selected_status == key %}selected{% endif %}>{{ label }}</option>
          {% endfor %}
        </select>
        <label class="text-muted small mb-0" for="sortSelect">Sort</label>
        <select id="sortSelect" name="sort" class="form-select form-select-sm" style="width:auto">
          <option value="newest" {% if selected_sort == 'newest' %}selected{% endif %}>Newest</option>
          <option value="oldest" {% if selected_sort == 'oldest' %}selected{% endif %}>Oldest</option>
        </select>
        <input type="search" name="q" value="{{ q }}" placeholder="Search order # or user" class="form-control form-control-sm" />
        <button class="btn btn-sm btn-outline-secondary" type="submit">Apply</button>
      </form>
    </div>
    <div class="mb-2 text-muted small" id="ordersSummary">Showing {{ summary_total_orders }} orders â€¢ Total {{ CURRENCY_SYMBOL }}{{ summary_total_amount|floatformat:2 }}</div>
    <div class="card">
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0 dash-table">
          <thead class="table-light"><tr><th>#</th><th>User</th><th>Status</th><th class="d-none d-sm-table-cell">Payment</th><th>Total</th><th class="d-none d-md-table-cell">Placed</th></tr></thead>
          <tbody id="ordersTbody">
            {% include "dashboard/_orders_rows.html" with orders=orders status_choices=status_choices %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>
{% block scripts %}
<script src="{% static 'js/orders_ajax.js' %}"></script>
{% endblock %}
{% endblock %}
