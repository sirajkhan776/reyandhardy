{% load static %}
{% with path=request.path %}
<nav class="mobile-bottom-nav d-md-none">
  <a href="/" class="mobile-nav-item {% if path == '/' %}active{% endif %}">
    <i class="bi bi-house{% if path == '/' %}-fill{% endif %}"></i>
    <span>Home</span>
  </a>
  <a href="{% if user.is_authenticated %}/accounts/you/{% else %}/accounts/login/{% endif %}" class="mobile-nav-item {% if path|slice:':13' == '/accounts/you' %}active{% endif %}">
    <i class="bi bi-person{% if path|slice:':9' == '/accounts' %}-fill{% endif %}"></i>
    <span>You</span>
  </a>
  <a href="/cart/" class="mobile-nav-item position-relative {% if path|slice:':6' == '/cart/' %}active{% endif %}">
    <i class="bi bi-bag{% if path|slice:':6' == '/cart/' %}-fill{% endif %}"></i>
    <span>Cart</span>
    {% if CART_COUNT and CART_COUNT > 0 %}
      <span class="badge rounded-pill bg-danger mobile-badge">{{ CART_COUNT }}</span>
    {% endif %}
  </a>
  <a href="javascript:void(0)" class="mobile-nav-item" data-bs-toggle="offcanvas" data-bs-target="#mobileMenuDrawer" aria-controls="mobileMenuDrawer">
    <i class="bi bi-list"></i>
    <span>Menu</span>
  </a>
</nav>

<div class="offcanvas offcanvas-bottom" tabindex="-1" id="mobileMenuDrawer" aria-labelledby="mobileMenuLabel">
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="mobileMenuLabel">Menu</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body">
    <form class="input-group mb-3" method="get" action="/search/">
      <input class="form-control" type="search" name="q" placeholder="Search your product" />
      <button class="btn btn-outline-primary" type="submit"><i class="bi bi-search"></i></button>
      <button class="btn btn-outline-secondary" type="button" id="imageSearchBtnMobile" title="Search with image"><i class="bi bi-camera"></i></button>
    </form>
    <form id="imageSearchFormMobile" method="post" action="/search/" enctype="multipart/form-data" class="d-none">
      {% csrf_token %}
      <input id="imageSearchInputMobile" type="file" name="image" accept="image/*" />
      <input id="imageSearchInputMobileCam" type="file" name="image" accept="image/*" capture="environment" />
    </form>
    <div class="row g-2">
      <div class="col-12"><strong>Categories</strong></div>
      {% for c in ALL_CATEGORIES %}
        <div class="col-6"><a class="btn btn-outline-secondary w-100" href="/category/{{ c.slug }}/">{{ c.name }}</a></div>
      {% empty %}
        <div class="col-12 text-muted small">No categories yet.</div>
      {% endfor %}
    </div>
    <hr />
  <div class="d-grid gap-2">
      {% if user.is_staff %}
        <a href="/dashboard/" class="btn btn-outline-primary">Admin Dashboard</a>
      {% endif %}
      <a href="/orders/" class="btn btn-outline-primary">My Orders</a>
      <a href="/wishlist/" class="btn btn-outline-primary">My Wishlist</a>
      {% if user.is_authenticated %}
        <a href="/accounts/logout/" class="btn btn-outline-danger">Logout</a>
      {% else %}
        <a href="/accounts/login/" class="btn btn-primary">Login / Signup</a>
      {% endif %}
    </div>
  </div>
</div>
{% endwith %}
