{% extends "base.html" %}
{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0">My Wishlist</h2>
    {% if items %}
      <div class="text-muted small">{{ items|length }} item{% if items|length != 1 %}s{% endif %}</div>
    {% endif %}
  </div>

  {% if items %}
    <div class="row g-3 wish-grid">
      {% for item in items %}
        {% with p=item.product %}
        <div class="col-12 col-sm-6 col-md-4 col-lg-3">
          <div class="shadow-frame wish-card h-100">
            <div class="sf-actions">
              <a class="btn-icon" href="/wishlist/remove/{{ p.id }}/" title="Remove from wishlist"><i class="bi bi-x"></i></a>
              <a class="btn-icon" href="/product/{{ p.slug }}/" title="View"><i class="bi bi-eye"></i></a>
            </div>
            <a class="sf-image" href="/product/{{ p.slug }}/">
              {% with img=p.images.all.0 %}
                {% if img %}
                  <img src="{{ img.image.url }}" alt="{{ img.alt_text }}" loading="lazy" />
                {% else %}
                  <div class="product-img d-flex align-items-center justify-content-center text-muted" style="height:210px;">No Image</div>
                {% endif %}
              {% endwith %}
            </a>
            <div class="sf-body">
              <div class="sf-title">{{ p.name }}</div>
              <div>
                {% if p.sale_price %}
                  <span class="sf-price">{{ CURRENCY_SYMBOL }}{{ p.sale_price }}</span>
                  <span class="sf-price-old">{{ CURRENCY_SYMBOL }}{{ p.base_price }}</span>
                {% else %}
                  <span class="sf-price">{{ CURRENCY_SYMBOL }}{{ p.base_price }}</span>
                {% endif %}
              </div>
              <div class="d-flex gap-2 mt-2">
                <a href="/product/{{ p.slug }}/" class="btn btn-sm btn-gradient">View</a>
                <a href="/wishlist/remove/{{ p.id }}/" class="btn btn-sm btn-outline-danger">Remove</a>
              </div>
            </div>
          </div>
        </div>
        {% endwith %}
      {% endfor %}
    </div>
  {% else %}
    <div class="text-center py-5">
      <h5>Your wishlist is empty</h5>
      <a href="/" class="btn btn-primary mt-2">Browse Products</a>
    </div>
  {% endif %}
{% endblock %}
